{"version":3,"sources":["file:///Users/chicmic/Documents/InhouseCOCOS/ZipExtractor/node_modules/jszip/lib/load.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","_req3","_req4","url","define","exports","require","module","__filename","__dirname","utils","external","utf8","ZipEntries","Crc32Probe","nodejsUtils","checkEntryCRC32","zipEntry","Promise","resolve","reject","worker","decompressed","getContentWorker","pipe","on","e","streamInfo","crc32","Error","resume","data","options","zip","extend","base64","checkCRC32","optimizedBinaryString","createFolders","decodeFileName","utf8decode","isNode","isStream","prepareContent","then","zipEntries","load","promises","files","i","length","push","all","addFiles","results","shift","input","unsafeName","fileNameStr","safeName","file","binary","date","dir","comment","fileCommentStr","unixPermissions","dosPermissions","unsafeOriginalName","zipComment","_cjsExports"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from './utils';\nimport { __cjsMetaURL as _req0} from './external';\nimport { __cjsMetaURL as _req1} from './utf8';\nimport { __cjsMetaURL as _req2} from './zipEntries';\nimport { __cjsMetaURL as _req3} from './stream/Crc32Probe';\nimport { __cjsMetaURL as _req4} from './nodejsUtils';\nlet _cjsExports;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n \"use strict\";\n var utils = require(\"./utils\");\n var external = require(\"./external\");\n var utf8 = require(\"./utf8\");\n var ZipEntries = require(\"./zipEntries\");\n var Crc32Probe = require(\"./stream/Crc32Probe\");\n var nodejsUtils = require(\"./nodejsUtils\");\n\n /**\n  * Check the CRC32 of an entry.\n  * @param {ZipEntry} zipEntry the zip entry to check.\n  * @return {Promise} the result.\n  */\n function checkEntryCRC32(zipEntry) {\n     return new external.Promise(function (resolve, reject) {\n         var worker = zipEntry.decompressed.getContentWorker().pipe(new Crc32Probe());\n         worker.on(\"error\", function (e) {\n             reject(e);\n         })\n             .on(\"end\", function () {\n                 if (worker.streamInfo.crc32 !== zipEntry.decompressed.crc32) {\n                     reject(new Error(\"Corrupted zip : CRC32 mismatch\"));\n                 } else {\n                     resolve();\n                 }\n             })\n             .resume();\n     });\n }\n\n module.exports = function (data, options) {\n     var zip = this;\n     options = utils.extend(options || {}, {\n         base64: false,\n         checkCRC32: false,\n         optimizedBinaryString: false,\n         createFolders: false,\n         decodeFileName: utf8.utf8decode\n     });\n\n     if (nodejsUtils.isNode && nodejsUtils.isStream(data)) {\n         return external.Promise.reject(new Error(\"JSZip can't accept a stream when loading a zip file.\"));\n     }\n\n     return utils.prepareContent(\"the loaded zip file\", data, true, options.optimizedBinaryString, options.base64)\n         .then(function (data) {\n             var zipEntries = new ZipEntries(options);\n             zipEntries.load(data);\n             return zipEntries;\n         }).then(function checkCRC32(zipEntries) {\n             var promises = [external.Promise.resolve(zipEntries)];\n             var files = zipEntries.files;\n             if (options.checkCRC32) {\n                 for (var i = 0; i < files.length; i++) {\n                     promises.push(checkEntryCRC32(files[i]));\n                 }\n             }\n             return external.Promise.all(promises);\n         }).then(function addFiles(results) {\n             var zipEntries = results.shift();\n             var files = zipEntries.files;\n             for (var i = 0; i < files.length; i++) {\n                 var input = files[i];\n\n                 var unsafeName = input.fileNameStr;\n                 var safeName = utils.resolve(input.fileNameStr);\n\n                 zip.file(safeName, input.decompressed, {\n                     binary: true,\n                     optimizedBinaryString: true,\n                     date: input.date,\n                     dir: input.dir,\n                     comment: input.fileCommentStr.length ? input.fileCommentStr : null,\n                     unixPermissions: input.unixPermissions,\n                     dosPermissions: input.dosPermissions,\n                     createFolders: options.createFolders\n                 });\n                 if (!input.dir) {\n                     zip.file(safeName).unsafeOriginalName = unsafeName;\n                 }\n             }\n             if (zipEntries.zipComment.length) {\n                 zip.comment = zipEntries.zipComment;\n             }\n\n             return zip;\n         });\n };\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n\n\n}, () => ({\n  './utils': _req,\n  './external': _req0,\n  './utf8': _req1,\n  './zipEntries': _req2,\n  './stream/Crc32Probe': _req3,\n  './nodejsUtils': _req4,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}